seed: 4, epochs: 100, algorithm: FedOpt, optimizer: SGD, momentum: 0.9, weight_decay: 0.0005, num_clients: 10, batch_size: 64, learning_rate: 0.01, local_epochs: 5, model: lenet, dataset: MNIST, distribution: non-iid, im_iid_gamma: 0.01, tail_cls_from: 4, dirichlet_alpha: 0.5, cache_partition: False, gpu_idx: [0], num_workers: 0, record_time: False, num_adv: 4, attack: NoAttack, defense: Mean, attack_params: None, defense_params: None, benchmark: False, num_shards: 200, num_training_sample: 60000, num_channels: 1, num_classes: 10, mean: (0.1307,), std: (0.3081,), device: cpu, output: ./logs/FedOpt/MNIST_lenet/non-iid/MNIST_lenet_non-iid_NoAttack_Mean_100_10_0.01_FedOpt.txt

Started on Thu Oct  9 16:36:52 2025
Generating new dataset split: non-iid
Number of clients: 10, Type: <class 'int'>
Performing Dirichlet non-iid partition (alpha=0.5)
Calling dirichlet_split_noniid with: labels, alpha=0.5, n_clients=10
Converting client indices to torch tensors...
Successfully created 10 client partitions
Validating partitions...
Total samples distributed: 60000/60000
Client 0: 7497 samples
Client 1: 6585 samples
Client 2: 3503 samples
Client 3: 5112 samples
Client 4: 5857 samples
Client 5: 7536 samples
Client 6: 3752 samples
Client 7: 6682 samples
Client 8: 4192 samples
Client 9: 9284 samples
non-iid partition finished successfully.
Data partitioned
Clients and server are initialized
Starting Training...
Epoch 0  		Train Acc: 0.1566	Train loss: 0.0355	Test Acc: 0.0958	Test loss: 0.0360
Epoch 1  		Train Acc: 0.2047	Train loss: 0.0348	Test Acc: 0.0958	Test loss: 0.0359
Epoch 2  		Train Acc: 0.2313	Train loss: 0.0339	Test Acc: 0.0958	Test loss: 0.0356
Epoch 3  		Train Acc: 0.2375	Train loss: 0.0324	Test Acc: 0.0958	Test loss: 0.0352
Epoch 4  		Train Acc: 0.2719	Train loss: 0.0308	Test Acc: 0.2705	Test loss: 0.0339
Epoch 5  		Train Acc: 0.3800	Train loss: 0.0284	Test Acc: 0.3797	Test loss: 0.0323
Epoch 6  		Train Acc: 0.4866	Train loss: 0.0256	Test Acc: 0.5340	Test loss: 0.0285
Epoch 7  		Train Acc: 0.5956	Train loss: 0.0221	Test Acc: 0.6074	Test loss: 0.0230
Epoch 8  		Train Acc: 0.6962	Train loss: 0.0166	Test Acc: 0.7352	Test loss: 0.0159
Epoch 9  		Train Acc: 0.7859	Train loss: 0.0119	Test Acc: 0.7487	Test loss: 0.0123
Epoch 10 		Train Acc: 0.7930	Train loss: 0.0100	Test Acc: 0.8125	Test loss: 0.0096
Epoch 11 		Train Acc: 0.8347	Train loss: 0.0084	Test Acc: 0.8249	Test loss: 0.0089
Epoch 12 		Train Acc: 0.8538	Train loss: 0.0077	Test Acc: 0.8545	Test loss: 0.0079
Epoch 13 		Train Acc: 0.8694	Train loss: 0.0068	Test Acc: 0.8582	Test loss: 0.0076
Epoch 14 		Train Acc: 0.8675	Train loss: 0.0066	Test Acc: 0.8686	Test loss: 0.0068
Epoch 15 		Train Acc: 0.8800	Train loss: 0.0063	Test Acc: 0.8812	Test loss: 0.0063
Epoch 16 		Train Acc: 0.8919	Train loss: 0.0056	Test Acc: 0.8869	Test loss: 0.0059
Epoch 17 		Train Acc: 0.8978	Train loss: 0.0051	Test Acc: 0.8962	Test loss: 0.0056
Epoch 18 		Train Acc: 0.9012	Train loss: 0.0051	Test Acc: 0.8969	Test loss: 0.0054
Epoch 19 		Train Acc: 0.8994	Train loss: 0.0053	Test Acc: 0.9059	Test loss: 0.0050
Epoch 20 		Train Acc: 0.9089	Train loss: 0.0048	Test Acc: 0.9134	Test loss: 0.0047
Epoch 21 		Train Acc: 0.9147	Train loss: 0.0042	Test Acc: 0.9106	Test loss: 0.0047
Epoch 22 		Train Acc: 0.9203	Train loss: 0.0041	Test Acc: 0.9200	Test loss: 0.0043
Epoch 23 		Train Acc: 0.9270	Train loss: 0.0040	Test Acc: 0.9216	Test loss: 0.0041
Epoch 24 		Train Acc: 0.9309	Train loss: 0.0036	Test Acc: 0.9227	Test loss: 0.0040
Epoch 25 		Train Acc: 0.9259	Train loss: 0.0038	Test Acc: 0.9254	Test loss: 0.0039
Epoch 26 		Train Acc: 0.9281	Train loss: 0.0041	Test Acc: 0.9306	Test loss: 0.0037
Epoch 27 		Train Acc: 0.9309	Train loss: 0.0034	Test Acc: 0.9266	Test loss: 0.0038
Epoch 28 		Train Acc: 0.9372	Train loss: 0.0034	Test Acc: 0.9329	Test loss: 0.0035
Epoch 29 		Train Acc: 0.9469	Train loss: 0.0043	Test Acc: 0.9337	Test loss: 0.0034
Epoch 30 		Train Acc: 0.9447	Train loss: 0.0029	Test Acc: 0.9360	Test loss: 0.0034
Epoch 31 		Train Acc: 0.9414	Train loss: 0.0030	Test Acc: 0.9383	Test loss: 0.0032
Epoch 32 		Train Acc: 0.9441	Train loss: 0.0028	Test Acc: 0.9405	Test loss: 0.0031
Epoch 33 		Train Acc: 0.9422	Train loss: 0.0029	Test Acc: 0.9405	Test loss: 0.0030
Epoch 34 		Train Acc: 0.9503	Train loss: 0.0027	Test Acc: 0.9384	Test loss: 0.0031
Epoch 35 		Train Acc: 0.9551	Train loss: 0.0026	Test Acc: 0.9423	Test loss: 0.0030
Epoch 36 		Train Acc: 0.9547	Train loss: 0.0026	Test Acc: 0.9434	Test loss: 0.0028
Epoch 37 		Train Acc: 0.9478	Train loss: 0.0026	Test Acc: 0.9487	Test loss: 0.0027
Epoch 38 		Train Acc: 0.9463	Train loss: 0.0027	Test Acc: 0.9489	Test loss: 0.0027
Epoch 39 		Train Acc: 0.9472	Train loss: 0.0027	Test Acc: 0.9495	Test loss: 0.0026
Epoch 40 		Train Acc: 0.9512	Train loss: 0.0024	Test Acc: 0.9525	Test loss: 0.0025
Epoch 41 		Train Acc: 0.9516	Train loss: 0.0028	Test Acc: 0.9541	Test loss: 0.0025
Epoch 42 		Train Acc: 0.9497	Train loss: 0.0025	Test Acc: 0.9507	Test loss: 0.0025
Epoch 43 		Train Acc: 0.9537	Train loss: 0.0022	Test Acc: 0.9521	Test loss: 0.0024
Epoch 44 		Train Acc: 0.9428	Train loss: 0.0027	Test Acc: 0.9546	Test loss: 0.0024
Epoch 45 		Train Acc: 0.9537	Train loss: 0.0023	Test Acc: 0.9544	Test loss: 0.0023
Epoch 46 		Train Acc: 0.9566	Train loss: 0.0023	Test Acc: 0.9532	Test loss: 0.0023
Epoch 47 		Train Acc: 0.9513	Train loss: 0.0030	Test Acc: 0.9557	Test loss: 0.0022
Epoch 48 		Train Acc: 0.9575	Train loss: 0.0019	Test Acc: 0.9572	Test loss: 0.0021
Epoch 49 		Train Acc: 0.9606	Train loss: 0.0021	Test Acc: 0.9592	Test loss: 0.0021
Epoch 50 		Train Acc: 0.9622	Train loss: 0.0020	Test Acc: 0.9607	Test loss: 0.0021
Epoch 51 		Train Acc: 0.9603	Train loss: 0.0021	Test Acc: 0.9608	Test loss: 0.0020
Epoch 52 		Train Acc: 0.9628	Train loss: 0.0019	Test Acc: 0.9603	Test loss: 0.0020
Epoch 53 		Train Acc: 0.9625	Train loss: 0.0018	Test Acc: 0.9616	Test loss: 0.0020
Epoch 54 		Train Acc: 0.9610	Train loss: 0.0020	Test Acc: 0.9609	Test loss: 0.0019
Epoch 55 		Train Acc: 0.9635	Train loss: 0.0017	Test Acc: 0.9624	Test loss: 0.0019
Epoch 56 		Train Acc: 0.9641	Train loss: 0.0017	Test Acc: 0.9626	Test loss: 0.0019
Epoch 57 		Train Acc: 0.9666	Train loss: 0.0016	Test Acc: 0.9623	Test loss: 0.0019
Epoch 58 		Train Acc: 0.9664	Train loss: 0.0018	Test Acc: 0.9631	Test loss: 0.0018
Epoch 59 		Train Acc: 0.9669	Train loss: 0.0016	Test Acc: 0.9618	Test loss: 0.0019
Epoch 60 		Train Acc: 0.9694	Train loss: 0.0017	Test Acc: 0.9648	Test loss: 0.0018
Epoch 61 		Train Acc: 0.9662	Train loss: 0.0017	Test Acc: 0.9640	Test loss: 0.0018
Epoch 62 		Train Acc: 0.9629	Train loss: 0.0019	Test Acc: 0.9656	Test loss: 0.0017
Epoch 63 		Train Acc: 0.9692	Train loss: 0.0017	Test Acc: 0.9665	Test loss: 0.0016
Epoch 64 		Train Acc: 0.9713	Train loss: 0.0015	Test Acc: 0.9677	Test loss: 0.0016
Epoch 65 		Train Acc: 0.9669	Train loss: 0.0018	Test Acc: 0.9672	Test loss: 0.0016
Epoch 66 		Train Acc: 0.9688	Train loss: 0.0016	Test Acc: 0.9674	Test loss: 0.0017
Epoch 67 		Train Acc: 0.9656	Train loss: 0.0018	Test Acc: 0.9676	Test loss: 0.0016
Epoch 68 		Train Acc: 0.9703	Train loss: 0.0015	Test Acc: 0.9686	Test loss: 0.0016
Epoch 69 		Train Acc: 0.9766	Train loss: 0.0013	Test Acc: 0.9688	Test loss: 0.0016
Epoch 70 		Train Acc: 0.9708	Train loss: 0.0017	Test Acc: 0.9693	Test loss: 0.0015
Epoch 71 		Train Acc: 0.9734	Train loss: 0.0014	Test Acc: 0.9686	Test loss: 0.0016
Epoch 72 		Train Acc: 0.9681	Train loss: 0.0015	Test Acc: 0.9688	Test loss: 0.0015
Epoch 73 		Train Acc: 0.9691	Train loss: 0.0016	Test Acc: 0.9669	Test loss: 0.0016
Epoch 74 		Train Acc: 0.9697	Train loss: 0.0014	Test Acc: 0.9690	Test loss: 0.0015
Epoch 75 		Train Acc: 0.9669	Train loss: 0.0015	Test Acc: 0.9687	Test loss: 0.0016
Epoch 76 		Train Acc: 0.9676	Train loss: 0.0016	Test Acc: 0.9693	Test loss: 0.0015
Epoch 77 		Train Acc: 0.9675	Train loss: 0.0018	Test Acc: 0.9695	Test loss: 0.0015
Epoch 78 		Train Acc: 0.9678	Train loss: 0.0016	Test Acc: 0.9711	Test loss: 0.0015
Epoch 79 		Train Acc: 0.9711	Train loss: 0.0015	Test Acc: 0.9718	Test loss: 0.0014
Epoch 80 		Train Acc: 0.9725	Train loss: 0.0013	Test Acc: 0.9717	Test loss: 0.0014
Epoch 81 		Train Acc: 0.9681	Train loss: 0.0015	Test Acc: 0.9724	Test loss: 0.0014
Epoch 82 		Train Acc: 0.9668	Train loss: 0.0017	Test Acc: 0.9728	Test loss: 0.0014
Epoch 83 		Train Acc: 0.9713	Train loss: 0.0016	Test Acc: 0.9716	Test loss: 0.0014
Epoch 84 		Train Acc: 0.9688	Train loss: 0.0014	Test Acc: 0.9724	Test loss: 0.0014
Epoch 85 		Train Acc: 0.9725	Train loss: 0.0013	Test Acc: 0.9719	Test loss: 0.0014
Epoch 86 		Train Acc: 0.9803	Train loss: 0.0011	Test Acc: 0.9740	Test loss: 0.0013
Epoch 87 		Train Acc: 0.9703	Train loss: 0.0015	Test Acc: 0.9743	Test loss: 0.0013
Epoch 88 		Train Acc: 0.9731	Train loss: 0.0013	Test Acc: 0.9746	Test loss: 0.0013
Epoch 89 		Train Acc: 0.9688	Train loss: 0.0014	Test Acc: 0.9741	Test loss: 0.0013
Epoch 90 		Train Acc: 0.9709	Train loss: 0.0015	Test Acc: 0.9732	Test loss: 0.0014
Epoch 91 		Train Acc: 0.9781	Train loss: 0.0012	Test Acc: 0.9744	Test loss: 0.0013
Epoch 92 		Train Acc: 0.9747	Train loss: 0.0014	Test Acc: 0.9755	Test loss: 0.0012
Epoch 93 		Train Acc: 0.9775	Train loss: 0.0012	Test Acc: 0.9747	Test loss: 0.0012
Epoch 94 		Train Acc: 0.9789	Train loss: 0.0012	Test Acc: 0.9754	Test loss: 0.0012
Epoch 95 		Train Acc: 0.9768	Train loss: 0.0013	Test Acc: 0.9739	Test loss: 0.0013
Epoch 96 		Train Acc: 0.9762	Train loss: 0.0012	Test Acc: 0.9750	Test loss: 0.0012
Epoch 97 		Train Acc: 0.9706	Train loss: 0.0014	Test Acc: 0.9739	Test loss: 0.0012
Epoch 98 		Train Acc: 0.9793	Train loss: 0.0010	Test Acc: 0.9767	Test loss: 0.0012
Epoch 99 		Train Acc: 0.9769	Train loss: 0.0011	Test Acc: 0.9748	Test loss: 0.0013
Training finished on Thu Oct  9 16:52:26 2025 using 15 minutes and 33 seconds in total.
