seed: 4, epochs: 100, algorithm: FedOpt, optimizer: SGD, momentum: 0.9, weight_decay: 0.0005, num_clients: 3, batch_size: 64, learning_rate: 0.01, local_epochs: 5, model: lenet, dataset: MNIST, distribution: non-iid, im_iid_gamma: 0.01, tail_cls_from: 4, dirichlet_alpha: 0.5, cache_partition: False, gpu_idx: [0], num_workers: 0, record_time: False, num_adv: 1, attack: NoAttack, defense: Mean, attack_params: None, defense_params: None, benchmark: False, num_shards: 200, num_training_sample: 60000, num_channels: 1, num_classes: 10, mean: (0.1307,), std: (0.3081,), device: cpu, output: ./logs/FedOpt/MNIST_lenet/non-iid/MNIST_lenet_non-iid_NoAttack_Mean_100_3_0.01_FedOpt.txt

Started on Tue Sep 30 18:48:22 2025
Generating new indices
Doing non-iid partition (Dirichlet)
dirichlet alpha: 0.5
non-iid partition finished
Data partitioned
Clients and server are initialized
Starting Training...
Epoch 0  		Train Acc: 0.0906	Train loss: 0.0359	Test Acc: 0.0982	Test loss: 0.0362
Epoch 1  		Train Acc: 0.1615	Train loss: 0.0358	Test Acc: 0.0991	Test loss: 0.0361
Epoch 2  		Train Acc: 0.1812	Train loss: 0.0357	Test Acc: 0.1066	Test loss: 0.0361
Epoch 3  		Train Acc: 0.2000	Train loss: 0.0356	Test Acc: 0.1628	Test loss: 0.0360
Epoch 4  		Train Acc: 0.2594	Train loss: 0.0355	Test Acc: 0.2541	Test loss: 0.0360
Epoch 5  		Train Acc: 0.2823	Train loss: 0.0353	Test Acc: 0.2914	Test loss: 0.0359
Epoch 6  		Train Acc: 0.2740	Train loss: 0.0351	Test Acc: 0.2871	Test loss: 0.0357
Epoch 7  		Train Acc: 0.2885	Train loss: 0.0349	Test Acc: 0.2854	Test loss: 0.0355
Epoch 8  		Train Acc: 0.3146	Train loss: 0.0342	Test Acc: 0.2488	Test loss: 0.0351
Epoch 9  		Train Acc: 0.2906	Train loss: 0.0331	Test Acc: 0.2955	Test loss: 0.0342
Epoch 10 		Train Acc: 0.4031	Train loss: 0.0306	Test Acc: 0.3859	Test loss: 0.0321
Epoch 11 		Train Acc: 0.4542	Train loss: 0.0279	Test Acc: 0.4522	Test loss: 0.0286
Epoch 12 		Train Acc: 0.5490	Train loss: 0.0235	Test Acc: 0.5827	Test loss: 0.0221
Epoch 13 		Train Acc: 0.6198	Train loss: 0.0181	Test Acc: 0.6028	Test loss: 0.0190
Epoch 14 		Train Acc: 0.6813	Train loss: 0.0149	Test Acc: 0.7768	Test loss: 0.0124
Epoch 15 		Train Acc: 0.7594	Train loss: 0.0113	Test Acc: 0.8237	Test loss: 0.0100
Epoch 16 		Train Acc: 0.8187	Train loss: 0.0085	Test Acc: 0.8094	Test loss: 0.0093
Epoch 17 		Train Acc: 0.8385	Train loss: 0.0079	Test Acc: 0.8540	Test loss: 0.0075
Epoch 18 		Train Acc: 0.8323	Train loss: 0.0084	Test Acc: 0.8421	Test loss: 0.0081
Epoch 19 		Train Acc: 0.8323	Train loss: 0.0079	Test Acc: 0.8755	Test loss: 0.0067
Epoch 20 		Train Acc: 0.8594	Train loss: 0.0064	Test Acc: 0.8875	Test loss: 0.0063
Epoch 21 		Train Acc: 0.8990	Train loss: 0.0056	Test Acc: 0.8847	Test loss: 0.0061
Epoch 22 		Train Acc: 0.8854	Train loss: 0.0062	Test Acc: 0.8993	Test loss: 0.0054
Epoch 23 		Train Acc: 0.9021	Train loss: 0.0053	Test Acc: 0.9017	Test loss: 0.0051
Epoch 24 		Train Acc: 0.8937	Train loss: 0.0058	Test Acc: 0.9112	Test loss: 0.0047
Epoch 25 		Train Acc: 0.9219	Train loss: 0.0047	Test Acc: 0.9126	Test loss: 0.0047
Epoch 26 		Train Acc: 0.9188	Train loss: 0.0046	Test Acc: 0.9115	Test loss: 0.0046
Epoch 27 		Train Acc: 0.9062	Train loss: 0.0044	Test Acc: 0.9172	Test loss: 0.0044
Epoch 28 		Train Acc: 0.9115	Train loss: 0.0045	Test Acc: 0.9248	Test loss: 0.0041
Epoch 29 		Train Acc: 0.8990	Train loss: 0.0049	Test Acc: 0.9238	Test loss: 0.0041
Epoch 30 		Train Acc: 0.9177	Train loss: 0.0038	Test Acc: 0.9225	Test loss: 0.0040
Epoch 31 		Train Acc: 0.9333	Train loss: 0.0037	Test Acc: 0.9287	Test loss: 0.0038
Epoch 32 		Train Acc: 0.9281	Train loss: 0.0039	Test Acc: 0.9283	Test loss: 0.0037
Epoch 33 		Train Acc: 0.9167	Train loss: 0.0041	Test Acc: 0.9324	Test loss: 0.0035
Epoch 34 		Train Acc: 0.9302	Train loss: 0.0033	Test Acc: 0.9393	Test loss: 0.0033
Epoch 35 		Train Acc: 0.9219	Train loss: 0.0034	Test Acc: 0.9372	Test loss: 0.0033
Epoch 36 		Train Acc: 0.9292	Train loss: 0.0035	Test Acc: 0.9387	Test loss: 0.0032
Epoch 37 		Train Acc: 0.9135	Train loss: 0.0041	Test Acc: 0.9382	Test loss: 0.0033
Epoch 38 		Train Acc: 0.9313	Train loss: 0.0034	Test Acc: 0.9436	Test loss: 0.0031
Epoch 39 		Train Acc: 0.9250	Train loss: 0.0038	Test Acc: 0.9417	Test loss: 0.0031
Epoch 40 		Train Acc: 0.9396	Train loss: 0.0029	Test Acc: 0.9355	Test loss: 0.0033
Epoch 41 		Train Acc: 0.9271	Train loss: 0.0036	Test Acc: 0.9440	Test loss: 0.0030
Epoch 42 		Train Acc: 0.9469	Train loss: 0.0029	Test Acc: 0.9486	Test loss: 0.0027
Epoch 43 		Train Acc: 0.9490	Train loss: 0.0026	Test Acc: 0.9460	Test loss: 0.0028
Epoch 44 		Train Acc: 0.9427	Train loss: 0.0030	Test Acc: 0.9488	Test loss: 0.0027
Epoch 45 		Train Acc: 0.9562	Train loss: 0.0021	Test Acc: 0.9459	Test loss: 0.0027
Epoch 46 		Train Acc: 0.9458	Train loss: 0.0026	Test Acc: 0.9463	Test loss: 0.0028
Epoch 47 		Train Acc: 0.9510	Train loss: 0.0024	Test Acc: 0.9506	Test loss: 0.0027
Epoch 48 		Train Acc: 0.9260	Train loss: 0.0030	Test Acc: 0.9522	Test loss: 0.0025
Epoch 49 		Train Acc: 0.9635	Train loss: 0.0020	Test Acc: 0.9444	Test loss: 0.0028
Epoch 50 		Train Acc: 0.9375	Train loss: 0.0029	Test Acc: 0.9559	Test loss: 0.0023
Epoch 51 		Train Acc: 0.9542	Train loss: 0.0025	Test Acc: 0.9546	Test loss: 0.0024
Epoch 52 		Train Acc: 0.9594	Train loss: 0.0022	Test Acc: 0.9530	Test loss: 0.0024
Epoch 53 		Train Acc: 0.9500	Train loss: 0.0026	Test Acc: 0.9564	Test loss: 0.0022
Epoch 54 		Train Acc: 0.9594	Train loss: 0.0019	Test Acc: 0.9594	Test loss: 0.0021
Epoch 55 		Train Acc: 0.9377	Train loss: 0.0027	Test Acc: 0.9577	Test loss: 0.0022
Epoch 56 		Train Acc: 0.9635	Train loss: 0.0019	Test Acc: 0.9590	Test loss: 0.0022
Epoch 57 		Train Acc: 0.9688	Train loss: 0.0018	Test Acc: 0.9609	Test loss: 0.0021
Epoch 58 		Train Acc: 0.9531	Train loss: 0.0022	Test Acc: 0.9575	Test loss: 0.0022
Epoch 59 		Train Acc: 0.9500	Train loss: 0.0020	Test Acc: 0.9595	Test loss: 0.0020
Epoch 60 		Train Acc: 0.9479	Train loss: 0.0032	Test Acc: 0.9531	Test loss: 0.0024
Epoch 61 		Train Acc: 0.9458	Train loss: 0.0024	Test Acc: 0.9566	Test loss: 0.0022
Epoch 62 		Train Acc: 0.9573	Train loss: 0.0021	Test Acc: 0.9560	Test loss: 0.0021
Epoch 63 		Train Acc: 0.9604	Train loss: 0.0020	Test Acc: 0.9611	Test loss: 0.0020
Epoch 64 		Train Acc: 0.9552	Train loss: 0.0024	Test Acc: 0.9619	Test loss: 0.0020
Epoch 65 		Train Acc: 0.9594	Train loss: 0.0021	Test Acc: 0.9631	Test loss: 0.0018
Epoch 66 		Train Acc: 0.9708	Train loss: 0.0014	Test Acc: 0.9663	Test loss: 0.0017
Epoch 67 		Train Acc: 0.9573	Train loss: 0.0021	Test Acc: 0.9656	Test loss: 0.0017
Epoch 68 		Train Acc: 0.9583	Train loss: 0.0019	Test Acc: 0.9640	Test loss: 0.0018
Epoch 69 		Train Acc: 0.9604	Train loss: 0.0019	Test Acc: 0.9649	Test loss: 0.0018
Epoch 70 		Train Acc: 0.9677	Train loss: 0.0015	Test Acc: 0.9680	Test loss: 0.0017
Epoch 71 		Train Acc: 0.9625	Train loss: 0.0019	Test Acc: 0.9649	Test loss: 0.0018
Epoch 72 		Train Acc: 0.9646	Train loss: 0.0018	Test Acc: 0.9625	Test loss: 0.0019
Epoch 73 		Train Acc: 0.9573	Train loss: 0.0022	Test Acc: 0.9674	Test loss: 0.0017
Epoch 74 		Train Acc: 0.9677	Train loss: 0.0016	Test Acc: 0.9669	Test loss: 0.0016
Epoch 75 		Train Acc: 0.9677	Train loss: 0.0020	Test Acc: 0.9675	Test loss: 0.0016
Epoch 76 		Train Acc: 0.9594	Train loss: 0.0019	Test Acc: 0.9681	Test loss: 0.0016
Epoch 77 		Train Acc: 0.9719	Train loss: 0.0017	Test Acc: 0.9657	Test loss: 0.0017
Epoch 78 		Train Acc: 0.9608	Train loss: 0.0018	Test Acc: 0.9691	Test loss: 0.0016
Epoch 79 		Train Acc: 0.9750	Train loss: 0.0014	Test Acc: 0.9706	Test loss: 0.0015
Epoch 80 		Train Acc: 0.9667	Train loss: 0.0015	Test Acc: 0.9670	Test loss: 0.0016
Epoch 81 		Train Acc: 0.9615	Train loss: 0.0018	Test Acc: 0.9666	Test loss: 0.0016
Epoch 82 		Train Acc: 0.9646	Train loss: 0.0016	Test Acc: 0.9701	Test loss: 0.0015
Epoch 83 		Train Acc: 0.9729	Train loss: 0.0014	Test Acc: 0.9704	Test loss: 0.0015
Epoch 84 		Train Acc: 0.9719	Train loss: 0.0016	Test Acc: 0.9701	Test loss: 0.0014
Epoch 85 		Train Acc: 0.9656	Train loss: 0.0018	Test Acc: 0.9732	Test loss: 0.0013
Epoch 86 		Train Acc: 0.9552	Train loss: 0.0022	Test Acc: 0.9702	Test loss: 0.0015
Epoch 87 		Train Acc: 0.9750	Train loss: 0.0015	Test Acc: 0.9724	Test loss: 0.0014
Epoch 88 		Train Acc: 0.9667	Train loss: 0.0017	Test Acc: 0.9741	Test loss: 0.0014
Epoch 89 		Train Acc: 0.9760	Train loss: 0.0014	Test Acc: 0.9730	Test loss: 0.0014
Epoch 90 		Train Acc: 0.9771	Train loss: 0.0011	Test Acc: 0.9731	Test loss: 0.0014
Epoch 91 		Train Acc: 0.9688	Train loss: 0.0018	Test Acc: 0.9720	Test loss: 0.0014
Epoch 92 		Train Acc: 0.9729	Train loss: 0.0017	Test Acc: 0.9722	Test loss: 0.0014
Epoch 93 		Train Acc: 0.9688	Train loss: 0.0016	Test Acc: 0.9733	Test loss: 0.0014
Epoch 94 		Train Acc: 0.9667	Train loss: 0.0019	Test Acc: 0.9699	Test loss: 0.0015
Epoch 95 		Train Acc: 0.9802	Train loss: 0.0012	Test Acc: 0.9724	Test loss: 0.0013
Epoch 96 		Train Acc: 0.9729	Train loss: 0.0013	Test Acc: 0.9737	Test loss: 0.0013
Epoch 97 		Train Acc: 0.9750	Train loss: 0.0012	Test Acc: 0.9751	Test loss: 0.0012
Epoch 98 		Train Acc: 0.9719	Train loss: 0.0014	Test Acc: 0.9765	Test loss: 0.0012
Epoch 99 		Train Acc: 0.9698	Train loss: 0.0015	Test Acc: 0.9760	Test loss: 0.0012
Training finished on Tue Sep 30 18:51:02 2025 using 2 minutes and 39 seconds in total.
